<div style="margin: 15px; margin-right: 30px; margin-top: 50px;">
    <form class="layui-form record-form">
        <input type="hidden" name="id" value="{$info['id']|default:''}">
        <div class="layui-form-item">
            <label class="layui-form-label">标题</label>
            <div class="layui-input-block">
                <input type="text" name="title" value="{$info['title']|default:''}" lay-verify="title" placeholder="请输入标题" autocomplete="off" class="layui-input">
            </div>
         </div>
        <div class="layui-form-item">
            <label class="layui-form-label">副标题</label>
            <div class="layui-input-block">
                <input type="text" name="sub_title" value="{$info['sub_title']|default:''}" lay-verify="sub_title" placeholder="请输入副标题" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">价格</label>
            <div class="layui-input-block">
                <input type="text" name="price" value="{$info['price']|default:''}" lay-verify="price" placeholder="请输入价格" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">省市区</label>
            <div class="layui-input-block">
                {local app=city act=select param1=$info.province_id  param2=$info.city_id  param3=$info.area_id }
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">地址</label>
            <div class="layui-input-block">
                <input type="text" name="address" value="{$info['address']|default:''}" lay-verify="address" placeholder="请输入地址" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">联系电话</label>
            <div class="layui-input-block">
                <input type="text" name="tel" value="{$info['tel']|default:''}" lay-verify="tel" placeholder="请输入联系电话" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">封面图</label>

            <div class="layui-upload-drag " id="cover">
                <if $info['cover']|default:''>
                <img src="{$info['cover']}" lay-event="thumb" />
                <i class="layui-icon"></i>
                <p>请上传封面图</p>
                </if>
            </div>
           <input type="hidden" name="cover" value="{$info['cover']}" />
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">顶部图片</label>
            <div class="layui-upload-drag" id="top_img">
                <if $info['top_img']|default:''>
                <img src="{$info['top_img']}" lay-event="thumb" />
                <i class="layui-icon"></i>
                <p>请上传顶部图片</p>
                </if>
            </div>
           <input type="hidden" name="top_img" value="{$info['top_img']}" />
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">所属行业</label>
            <div class="layui-input-inline">
                <select name="industry_id" lay-filter="select-role" lay-verify="">
                    <option value="">-- 选择培训行业 --</option>
                    {foreach from=$train_industry_list key=key item=row}
                    <option value="{$key}" {if $info.industry_id eq $key }selected{/if}>{$row}</option>
                    {/foreach}
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">所属级别</label>
            <div class="layui-input-inline">
                <select name="level_id" lay-filter="select-role" lay-verify="">
                    <option value="">-- 选择培训级别 --</option>
                    {foreach from=$train_level_list key=key item=row}
                    <option value="{$key}" {if $info.level_id eq $key }selected{/if}>{$row}</option>
                    {/foreach}
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">所属周期</label>
            <div class="layui-input-inline">
                <select name="cycle_id" lay-filter="select-role" lay-verify="">
                    <option value="">-- 选择培训周期 --</option>
                    {foreach from=$train_cycle_list key=key item=row}
                    <option value="{$key}" {if $info.cycle_id eq $key }selected{/if}>{$row}</option>
                    {/foreach}
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">是否可用优惠券</label>
            <div class="layui-input-block">
                <input type="radio" name="is_coupon" value="1" lay-verify=""  autocomplete="off" class="layui-input" title="是" {if $info['is_coupon'] eq 1 }checked='checked'{/if}>
                <input type="radio" name="is_coupon" value="2" lay-verify=""  autocomplete="off" class="layui-input" title="否" {if $info['is_coupon'] eq 2 }checked='checked'{/if}>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">是否推荐课程</label>
            <div class="layui-input-block">
                <input type="radio" name="is_recommend" value="1" lay-verify=""  autocomplete="off" class="layui-input" title="是" {if $info['is_coupon'] eq 1 }checked='checked'{/if}>
                <input type="radio" name="is_recommend" value="2" lay-verify=""  autocomplete="off" class="layui-input" title="否" {if $info['is_coupon'] eq 2 }checked='checked'{/if}>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">课时数</label>
            <div class="layui-input-block">
                <input type="text" name="class_num" value="{$info['class_num']|default:''}" lay-verify="class_num" placeholder="请输入课时数" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">课时长</label>
            <div class="layui-input-block">
                <input type="text" name="class_duration" value="{$info['class_duration']|default:''}" lay-verify="class_duration" placeholder="请输入课时长" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">上课时间</label>
            <div class="layui-input-block">
                <input type="text" id="class_date" name="class_date" value="{$info['class_date']|default:''}" lay-verify="class_date" placeholder="请输入上课时间" autocomplete="off" class="layui-input">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">课程介绍</label>
            <div class="layui-input-block">
               <textarea class=" " name="class_intro"   id="myEditor">{$info['class_intro']|default:''}</textarea>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">审核认证</label>
            <div class="layui-input-inline">
                <select name="status" lay-filter="real_status" >
                    <option value="">-- 选择审核认证 --</option>
                    {foreach from=$statusList key=key item=row}
                    <option value="{$row.id}" {if $info.status eq $row.id }selected{/if}>{$row.name}</option>
                    {/foreach}
                </select>
            </div>
        </div>
        <div class="layui-form-item" id="res_status">
            <label class="layui-form-label">未通过原因</label>
            <div class="layui-input-block" >
                <input type="text" name="res_status"  value="{$info['res_status']|default:''}"  placeholder="请输入未通过原因" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div><br><br><br><br><br></div>
        <div class="layui-form-item layui-hide">
            <div class="layui-input-block">
                <button class="layui-btn" lay-submit lay-filter="edit">提交</button>
                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
            </div>
        </div>
    </form>
</div>
<script>
layui.use(['form','ueditor'], function() {
        var $ = layui.jquery,
            form = layui.form;

        //建立富文本编辑器
    var ueditor = layui.ueditor;
    ueditor.init({
        elm:"myEditor",//编辑器所在元素
        opt:null,//原始编辑器创建时带的参数

         configUrl: null,// 采用自定义的配置文件，不用官方的配置文件
        serverUrl: null,//  服务器统一请求接口路径，官方示例为jsp/controller.jsp，可重置此接口地址
        // 当初始化完成时，会执行此方法，返回创建的editor编辑器实例
        done: function (editor) {

        }
    });
    //板块监听
    form.on('select(real_status)', function(data){
        var type = data.value;
        change(type);
    });

    function change(type) {
        if(3==type){
            $('#res_status').show();
        }else{
            $('#res_status').hide();
        }
    }
    form.verify({
            title: function(value){
                if(!value){
                    return '标题不能为空';
                }
                if(value.length < 2){
                    return '标题至少得2个字符啊';
                }
            },
            sub_title: function(value){
                if(value){
                    if(!new RegExp("^[a-zA-Z0-9_\u4e00-\u9fa5\\s·]+$").test(value)){
                        return '用户名不能有特殊字符';
                    }
                }
            },
            class_num: function(value){
                if(!value){
                    return '课时数不能为空';
                }
                if(value.length < 1){
                    return '课时数不能为0';
                }
            },
            class_duration: function(value){
                if(!value){
                    return '课时数不能为空';
                }
                if(value.length <1){
                    return '课时长不能小于0';
                }
            },
              tel:function(value){
                if(!value){
                    return '电话不能为空';
                }

             },
             tel: function(input) {
                var regex = /^[1][3,4,5,7,8][0-9]{9}$/;
                if(input.match(regex)) {
                    return true;
                } else {
                    return false;
                }
            }
    });
    //上传图片
        layui.use(['upload'], function() {
            var $ = layui.jquery,
                upload = layui.upload;

            var href = _this_module_url + '/Index/upload_logo';
            upload.render({
                elem: '#cover',
                url: href,
                done: function(res) {
                    console.log(res);
                    if (!res.status) {
                        layer.alert(res.msg);
                        return false;
                    }
                    layer.msg(res.msg, {
                        time: 1000
                    }, function() { });
                   $('#cover').html('<img src="' + res.data[0] + '" lay-event="thumb" />');
                    $('form [name=cover]').val(res.data[0]);

                },
            });
            upload.render({
                elem: '#top_img',
                url: href,
                done: function(res) {
                    console.log(res);
                    if (!res.status) {
                        layer.alert(res.msg);
                        return false;
                    }
                    layer.msg(res.msg, {
                        time: 1000
                    }, function() { });
                   $('#top_img').html('<img src="' + res.data[0] + '" lay-event="thumb" />');
                    $('form [name=top_img]').val(res.data[0]);

                },
            });
        });
});
</script>
